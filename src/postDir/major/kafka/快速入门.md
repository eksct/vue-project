#### 一、获取kafka
1. kafka官网下载
2. 命令下载
```bash
$ tar -xzf kafka_2.13-4.0.0.tgz
$ cd kafka_2.13-4.0.0
```
3. docker镜像启动
#### 二、启动kafka
注意：**从4.0开始**，kafka不再支持使用ZooKeeper作为协调中心和元数据仓库，仅支持 KRaft 模式。（2025.03）
所以理论上， 用到kafka的项目基本上要启动zookeeper+kafka
启动kafka
```bash
$ bin/kafka-storage.sh format --standalone -t $KAFKA_CLUSTER_ID -c config/server.properties
$ bin/kafka-server-start.sh config/server.properties

```
Docker
```bash
$ docker run -p 9092:9092 apache/kafka-native:4.0.0
```
windows下把脚本扩展名修改为.bat启动
运行`kafka-topics.sh`不带任何参数的命令即可显示使用情况信息。
```bash
$ bin/kafka-topics.sh --describe --topic quickstart-events --bootstrap-server localhost:9092
Topic: quickstart-events        TopicId: NPmZHyhbR9y00wMglMH2sg PartitionCount: 1       ReplicationFactor: 1	Configs:
Topic: quickstart-events Partition: 0    Leader: 0   Replicas: 0 Isr: 0
```
运行list（列表）命令来查看这个topic
```bash
> bin /kafka-topics.sh --list --zookeeper localhost:2181
test
```
#### 三、基本操作
1. 创建一个名为“test”的topic，它有一个分区和一个副本：
```bash
> bin``/kafka-topics``.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic` `test
```
2. 生产者发布事件(生产消息)
在test主题中发布两条消息
```bash
$ bin/kafka-console-producer.sh --topic test --bootstrap-server localhost:9092
>This is my first event
>This is my second event
```
中文文档上:
```bash
`> bin``/kafka-console-producer``.sh --broker-list localhost:9092 --topic` `test`

`This is a message`

`This is another message`
```
3. 消费者订阅事件(消费消息)
```bash
$ bin/kafka-console-consumer.sh --topic test --from-beginning --bootstrap-server localhost:9092
This is my first event
This is my second event
```
中文文档上:
```bash
`> bin``/kafka-console-consumer``.sh --bootstrap-server localhost:9092 --topic` `test` `--from-beginning`

`This is a message`

`This is another message`
```

#### 用 Kafka Connect 将数据作为事件流导入/导出
确保在 Connect 工作进程的配置中添加`connect-file-4.0.0.jar`
然后编写 Kafka Connect 的配置文件；第一个始终是 Kafka Connect 进程的配置
```bash
$ bin/connect-standalone.sh config/connect-standalone.properties config/connect-file-source.properties config/connect-file-sink.properties
```

---
#### 消息模式
点对点模式:如果一个分区的消息只需要一个消费者进行消费，则可以把多个相同需求的消费者建组，由于消费者组“组内消费者对于一个分区的消息，只能一个消费者消费”的特性，则可以保证一对一。
发布订阅模式：每个消费者都在不同组内，一个消息可以被多个消费者消费。

如何保证不同分区内的消费顺序？给消息设置相同的key，同key消息会发到同一个分区。
