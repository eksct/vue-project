固件--[mqtt发布up/订阅down]--->emqx<---[mqtt订阅up/发布down]--服务端--->kafka

通过`MQTTConfiguration`设置生产者消费者订阅全部的topic，用`@MessagingGateway(defaultRequestChannel = "mqttProducerExecutorChannel")`指定消息发布的生产者通道，在**设备数据交互中心**`DefaultDeviceDataInteractionManager`设置一个消费者消费方法`@ServiceActivator(inputChannel = "mqttConsumerExecutorChannel")`——所有处理用的handler在最初已经全部注册为bean并注入handlerMap——校验，获取命令码，根据命令码拿到`handlersMap`里的handler，执行upStreamProcess方法。并构建消息，传输到kafka中，被服务端的kafka监听器监听，处理数据。最后视情况在kafka监听器内通过mqtt返回给固件。理解为服务端罢
kafka毕竟是一个中间件，kafuka+java服务端是一个整体。
一个充电桩与平台交互就是这么一个逻辑。